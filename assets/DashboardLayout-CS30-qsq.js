import{j as e,N as g,a as G,r as l,c as z,A as U,O as J}from"./index-4_f5pIIv.js";import{h as q,i as V,j as K,k as Q,l as W,m as X,n as Y,o as Z,p as ee,q as oe,F as E,r as ae,a as se,s as ne,t as re,u as te,v as ie}from"./index-O__zhACk.js";import{G as le}from"./iconBase-BPqFUofc.js";import{u as ce}from"./useAuthentication-OwBKS9a4.js";const de="_sidebar_ey5b3_1",me="_collapsed_ey5b3_31",ue="_expanded_ey5b3_39",_e="_logo_ey5b3_47",pe="_logoImage_ey5b3_65",ge="_nav_ey5b3_105",xe="_section_ey5b3_117",he="_link_ey5b3_145",je="_active_ey5b3_199",be="_toggleButton_ey5b3_241",ve="_sidebarMobileOpen_ey5b3_313",n={sidebar:de,collapsed:me,expanded:ue,logo:_e,logoImage:pe,nav:ge,section:xe,link:he,active:je,toggleButton:be,sidebarMobileOpen:ve},Ne=()=>{const{isExpanded:s,setIsExpanded:t,mobileOpen:c,setMobileOpen:_}=O();let r=!1;try{const i=localStorage.getItem("user");if(i){const m=JSON.parse(i);Number(m?.rol??m?.rol_user??m?.role??m?.tipo??m?.tipo_usuario)===0&&(r=!0)}}catch{}const j=()=>{t(!s)},d=()=>{c&&_(!1)};return e.jsxs("div",{className:`${n.sidebar} ${s?n.expanded:n.collapsed} ${c?n.sidebarMobileOpen:""}`,children:[e.jsxs("div",{className:n.logo,children:[e.jsx("img",{src:"/logo2.svg",alt:"Logo",className:n.logoImage}),s&&e.jsx("span",{children:"NuñezRA"})]}),e.jsxs("nav",{className:n.nav,children:[e.jsx("div",{className:n.section,children:e.jsxs(g,{to:"/dashboard",className:({isActive:i})=>`${n.link} ${i?n.active:""}`,onClick:d,children:[e.jsx(q,{}),s&&e.jsx("span",{children:"Cuestionarios"})]})}),e.jsxs("div",{className:n.section,children:[e.jsxs(g,{to:"/periodos",className:({isActive:i})=>`${n.link} ${i?n.active:""}`,onClick:d,children:[e.jsx(V,{}),s&&e.jsx("span",{children:"Periodos"})]}),e.jsxs(g,{to:"/asignar",className:({isActive:i})=>`${n.link} ${i?n.active:""}`,onClick:d,children:[e.jsx(K,{}),s&&e.jsx("span",{children:"Asignar Cuestionario"})]})]}),e.jsxs("div",{className:n.section,children:[e.jsxs(g,{to:"/seguimiento",className:({isActive:i})=>`${n.link} ${i?n.active:""}`,onClick:d,children:[e.jsx(Q,{}),s&&e.jsx("span",{children:"Seguimiento"})]}),e.jsxs(g,{to:"/resultados",className:({isActive:i})=>`${n.link} ${i?n.active:""}`,onClick:d,children:[e.jsx(W,{}),s&&e.jsx("span",{children:"Resultados"})]}),r&&e.jsxs(g,{to:"/reporte-aprendizaje",className:({isActive:i})=>`${n.link} ${i?n.active:""}`,onClick:d,children:[e.jsx(X,{}),s&&e.jsx("span",{children:"Consolidados"})]})]})]}),e.jsx("button",{className:n.toggleButton,onClick:j,"aria-label":s?"Contraer":"Expandir",children:s?e.jsx(Y,{}):e.jsx(Z,{})})]})};function fe(s){return le({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"},child:[]}]})(s)}const we="_navbar_75eci_1",Ce="_container_75eci_25",ye="_menuButton_75eci_47",Ie="_branding_75eci_117",Se="_logo_75eci_165",Be="_userSection_75eci_179",Ae="_userInfo_75eci_201",ke="_roleButton_75eci_241",De="_dropdownContainer_75eci_351",Ee="_userDropdownButton_75eci_359",$e="_userDropdownIcon_75eci_405",Oe="_dropdownArrow_75eci_423",Le="_rotated_75eci_439",Fe="_dropdownMenu_75eci_447",Te="_dropdownHeader_75eci_497",Me="_userDataRow_75eci_541",Re="_iconColumn_75eci_553",Pe="_dataColumn_75eci_573",He="_userNameText_75eci_591",Ge="_userEmailText_75eci_603",ze="_userRoleText_75eci_615",Ue="_userInfoIcon_75eci_629",Je="_dropdownDivider_75eci_651",qe="_dropdownLogoutButton_75eci_663",Ve="_modalOverlay_75eci_961",Ke="_modalContainer_75eci_1007",Qe="_modalHeader_75eci_1047",We="_modalIcon_75eci_1063",Xe="_modalBody_75eci_1087",Ye="_modalSubtext_75eci_1109",Ze="_modalActions_75eci_1121",eo="_modalCancelButton_75eci_1135",oo="_modalConfirmButton_75eci_1171",o={navbar:we,container:Ce,menuButton:ye,branding:Ie,logo:Se,userSection:Be,userInfo:Ae,roleButton:ke,dropdownContainer:De,userDropdownButton:Ee,userDropdownIcon:$e,dropdownArrow:Oe,rotated:Le,dropdownMenu:Fe,dropdownHeader:Te,userDataRow:Me,iconColumn:Re,dataColumn:Pe,userNameText:He,userEmailText:Ge,userRoleText:ze,userInfoIcon:Ue,dropdownDivider:Je,dropdownLogoutButton:qe,modalOverlay:Ve,modalContainer:Ke,modalHeader:Qe,modalIcon:We,modalBody:Xe,modalSubtext:Ye,modalActions:Ze,modalCancelButton:eo,modalConfirmButton:oo},ao=()=>{const s=G(),{user:t,logout:c}=ce(),{setMobileOpen:_}=O(),r=t?.rol??t?.rol_user??void 0,j=r===0||r==="0"||r==="admin"||r==="ADMIN",d=r===1||r==="1"||r==="docente"||r==="DOCENTE",i=r==="tester"||r==="TESTER",m=j?"Admin":d?"Docente":typeof r=="string"?r:"Docente",[p,f]=l.useState(!1),[L,I]=l.useState(!1),w=l.useRef(null),[C,S]=l.useState(t?.programa??null),[F,B]=l.useState(!1),T=async()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),await c(),s("/login-docente")},M=()=>{I(!0),f(!1)},R=()=>{I(!1)};l.useEffect(()=>{const y=x=>{w.current&&!w.current.contains(x.target)&&f(!1)};return document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[]);const P=()=>{f(!p)};l.useEffect(()=>{p&&!C&&(async()=>{try{B(!0);const x=t?.programa_id;if(x==null)return;const{data:a}=await z.get(U.programas.base),h=Array.isArray(a?.data?.programas)&&a?.data?.programas.length>0?a.data.programas[0]:Array.isArray(a?.programas)&&a?.programas.length>0?a.programas[0]:Array.isArray(a?.data?.programa)&&a?.data?.programa.length>0?a.data.programa[0]:Array.isArray(a?.programa)&&a?.programa.length>0?a.programa[0]:a?.data?.programa&&typeof a.data.programa=="object"?a.data.programa:a?.programa&&typeof a.programa=="object"?a.programa:a?.data&&typeof a.data=="object"&&a.data.nombre?{nombre:a.data.nombre}:a&&typeof a=="object"&&a.nombre?{nombre:a.nombre}:null;let v=null,k=null;if(h){const N=h?.id??h?.programa_id??void 0;N!=null&&!Number.isNaN(Number(N))&&(k=Number(N));const D=h?.nombre??h?.programa??void 0;typeof D=="string"&&(v=D)}k===99||/general/i.test(v??"")?S("General"):v&&S(String(v))}catch{}finally{B(!1)}})()},[p,C,t]);const H=t?.programa_id!==null&&t?.programa_id!==void 0,A=t?.programa_id;let b=H&&(C||t?.programa?.nombre||t?.programa)||null;return(A===99||A==="99"||/\(\s*General\s*\)/i.test(String(b??""))||/general/i.test(String(b??"")))&&(b="General"),e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:o.navbar,children:e.jsxs("div",{className:o.container,children:[e.jsx("button",{className:o.menuButton,onClick:()=>_(!0),"aria-label":"Abrir menú",children:e.jsx(fe,{})}),e.jsx("div",{className:o.branding,children:e.jsx("img",{src:"/logo.svg",alt:"Logo",className:o.logo})}),e.jsxs("div",{className:o.userSection,children:[j&&e.jsxs("button",{className:o.roleButton,title:"Panel de Administrador",children:[e.jsx(ee,{}),e.jsx("span",{children:"Admin"})]}),i&&e.jsxs("button",{className:o.roleButton,onClick:()=>s("/tester"),title:"Panel de Tester",children:[e.jsx(oe,{}),e.jsx("span",{children:"Tester"})]}),e.jsxs("div",{className:o.dropdownContainer,ref:w,children:[e.jsxs("button",{onClick:P,className:o.userDropdownButton,title:"Menú de usuario",children:[e.jsx(E,{className:o.userDropdownIcon}),e.jsx(ae,{className:`${o.dropdownArrow} ${p?o.rotated:""}`})]}),p&&e.jsxs("div",{className:o.dropdownMenu,children:[e.jsx("div",{className:o.dropdownHeader,children:e.jsx("div",{className:o.userInfo,children:e.jsxs("div",{className:o.userDataRow,children:[e.jsxs("div",{className:o.iconColumn,children:[e.jsx(E,{className:o.userInfoIcon}),e.jsx(se,{className:o.userInfoIcon}),e.jsx(ne,{className:o.userInfoIcon}),e.jsx(re,{className:o.userInfoIcon})]}),e.jsxs("div",{className:o.dataColumn,children:[e.jsx("span",{className:o.userNameText,children:t?.nombre}),e.jsx("span",{className:o.userEmailText,children:t?.email}),e.jsx("span",{className:o.userEmailText,children:F?"Cargando programa…":b||"Sin programa"}),e.jsx("span",{className:o.userRoleText,children:m})]})]})})}),e.jsx("div",{className:o.dropdownDivider}),e.jsxs("button",{onClick:M,className:o.dropdownLogoutButton,children:[e.jsx(te,{}),e.jsx("span",{children:"Cerrar sesión"})]})]})]})]})]})}),L&&e.jsx("div",{className:o.modalOverlay,children:e.jsxs("div",{className:o.modalContainer,children:[e.jsxs("div",{className:o.modalHeader,children:[e.jsx(ie,{className:o.modalIcon}),e.jsx("h3",{children:"Confirmar cierre de sesión"})]}),e.jsxs("div",{className:o.modalBody,children:[e.jsx("p",{children:"¿Estás seguro de que deseas cerrar sesión?"}),e.jsx("p",{className:o.modalSubtext,children:"Serás redirigido a la página de inicio de sesión."})]}),e.jsxs("div",{className:o.modalActions,children:[e.jsx("button",{onClick:T,className:o.modalConfirmButton,children:"Cerrar sesión"}),e.jsx("button",{onClick:R,className:o.modalCancelButton,children:"Cancelar"})]})]})})]})},so="_layout_1t3f5_1",no="_mainContainer_1t3f5_15",ro="_expanded_1t3f5_35",to="_collapsed_1t3f5_45",io="_main_1t3f5_15",lo="_overlay_1t3f5_81",co="_show_1t3f5_101",u={layout:so,mainContainer:no,expanded:ro,collapsed:to,main:io,overlay:lo,show:co},$=l.createContext(void 0),O=()=>{const s=l.useContext($);if(!s)throw new Error("useSidebar debe ser usado dentro de DashboardLayout");return s},go=()=>{const[s,t]=l.useState(()=>{try{const r=localStorage.getItem("sidebar_expanded");return r==null?!0:JSON.parse(r)===!0}catch{return!0}}),[c,_]=l.useState(!1);return l.useEffect(()=>{try{localStorage.setItem("sidebar_expanded",JSON.stringify(s))}catch{}},[s]),e.jsx($.Provider,{value:{isExpanded:s,setIsExpanded:t,mobileOpen:c,setMobileOpen:_},children:e.jsxs("div",{className:u.layout,children:[e.jsx(Ne,{}),e.jsx("div",{className:`${u.overlay} ${c?u.show:""}`,onClick:()=>_(!1),"aria-hidden":!c}),e.jsxs("div",{className:`${u.mainContainer} ${s?u.expanded:u.collapsed}`,children:[e.jsx(ao,{}),e.jsx("main",{className:u.main,children:e.jsx(J,{})})]})]})})};export{go as default,O as useSidebar};
