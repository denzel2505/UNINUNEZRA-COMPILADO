import{c as E,j as o,L as g,a as F,r as t,b as T,A as M,O as P}from"./index-DzgdolRr.js";import{h as R,i as H,j as U,k as z,l as q,m as G,n as J,o as V,p as W,F as f,q as K,a as Q,r as X,s as Y,t as Z,u as oo}from"./index-BglOwyC0.js";import{G as eo}from"./iconBase-L-zE4WbR.js";import{u as so}from"./useAuthentication-C1_h9Cef.js";const no="_sidebar_tws5j_1",ao="_collapsed_tws5j_16",to="_expanded_tws5j_20",ro="_logo_tws5j_24",lo="_logoImage_tws5j_33",co="_nav_tws5j_53",io="_section_tws5j_59",mo="_link_tws5j_73",uo="_active_tws5j_100",_o="_toggleButton_tws5j_121",xo="_sidebarMobileOpen_tws5j_157",n={sidebar:no,collapsed:ao,expanded:to,logo:ro,logoImage:lo,nav:co,section:io,link:mo,active:uo,toggleButton:_o,sidebarMobileOpen:xo},po=()=>{const a=E(),{isExpanded:s,setIsExpanded:l,mobileOpen:d,setMobileOpen:x}=B(),c=u=>a.pathname.startsWith(u)?n.active:"",i=()=>{l(!s)},m=()=>{d&&x(!1)};return o.jsxs("div",{className:`${n.sidebar} ${s?n.expanded:n.collapsed} ${d?n.sidebarMobileOpen:""}`,children:[o.jsxs("div",{className:n.logo,children:[o.jsx("img",{src:"/logo2.svg",alt:"Logo",className:n.logoImage}),s&&o.jsx("span",{children:"NuñezRA"})]}),o.jsxs("nav",{className:n.nav,children:[o.jsx("div",{className:n.section,children:o.jsxs(g,{to:"/dashboard",className:`${n.link} ${c("/dashboard")}`,onClick:m,children:[o.jsx(R,{}),s&&o.jsx("span",{children:"Cuestionarios"})]})}),o.jsxs("div",{className:n.section,children:[o.jsxs(g,{to:"/asignar",className:`${n.link} ${c("/asignar")}`,onClick:m,children:[o.jsx(H,{}),s&&o.jsx("span",{children:"Asignar Cuestionario"})]}),o.jsxs(g,{to:"/periodos",className:`${n.link} ${c("/periodos")}`,onClick:m,children:[o.jsx(U,{}),s&&o.jsx("span",{children:"Periodos"})]})]}),o.jsxs("div",{className:n.section,children:[o.jsxs(g,{to:"/seguimiento",className:`${n.link} ${c("/seguimiento")}`,onClick:m,children:[o.jsx(z,{}),s&&o.jsx("span",{children:"Seguimiento"})]}),o.jsxs(g,{to:"/resultados",className:`${n.link} ${c("/resultados")}`,onClick:m,children:[o.jsx(q,{}),s&&o.jsx("span",{children:"Resultados"})]})]})]}),o.jsx("button",{className:n.toggleButton,onClick:i,"aria-label":s?"Contraer":"Expandir",children:s?o.jsx(G,{}):o.jsx(J,{})})]})};function go(a){return eo({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"},child:[]}]})(a)}const vo="_navbar_1v35t_1",ho="_container_1v35t_13",jo="_menuButton_1v35t_24",wo="_branding_1v35t_59",bo="_logo_1v35t_83",No="_userSection_1v35t_90",Co="_userInfo_1v35t_101",fo="_roleButton_1v35t_121",Io="_dropdownContainer_1v35t_176",Bo="_userDropdownButton_1v35t_180",So="_userDropdownIcon_1v35t_203",yo="_dropdownArrow_1v35t_212",ko="_rotated_1v35t_220",Lo="_dropdownMenu_1v35t_224",Do="_dropdownHeader_1v35t_249",$o="_userDataRow_1v35t_271",Ao="_iconColumn_1v35t_277",Oo="_dataColumn_1v35t_287",Eo="_userNameText_1v35t_296",Fo="_userEmailText_1v35t_302",To="_userRoleText_1v35t_308",Mo="_userInfoIcon_1v35t_315",Po="_dropdownDivider_1v35t_326",Ro="_dropdownLogoutButton_1v35t_332",Ho="_modalOverlay_1v35t_481",Uo="_modalContainer_1v35t_504",zo="_modalHeader_1v35t_524",qo="_modalIcon_1v35t_532",Go="_modalBody_1v35t_544",Jo="_modalSubtext_1v35t_555",Vo="_modalActions_1v35t_561",Wo="_modalCancelButton_1v35t_568",Ko="_modalConfirmButton_1v35t_586",e={navbar:vo,container:ho,menuButton:jo,branding:wo,logo:bo,userSection:No,userInfo:Co,roleButton:fo,dropdownContainer:Io,userDropdownButton:Bo,userDropdownIcon:So,dropdownArrow:yo,rotated:ko,dropdownMenu:Lo,dropdownHeader:Do,userDataRow:$o,iconColumn:Ao,dataColumn:Oo,userNameText:Eo,userEmailText:Fo,userRoleText:To,userInfoIcon:Mo,dropdownDivider:Po,dropdownLogoutButton:Ro,modalOverlay:Ho,modalContainer:Uo,modalHeader:zo,modalIcon:qo,modalBody:Go,modalSubtext:Jo,modalActions:Vo,modalCancelButton:Wo,modalConfirmButton:Ko},Qo=()=>{const a=F(),{user:s,logout:l}=so(),{setMobileOpen:d}=B(),x=s?.rol==="admin",c=s?.rol==="tester",i=s?.rol,m=i===1||i==="1"?"Docente":typeof i=="string"?i:String(i??"Docente"),[u,h]=t.useState(!1),[S,b]=t.useState(!1),j=t.useRef(null),[v,y]=t.useState(s?.programa??null),[k,N]=t.useState(!1),L=async()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),await l(),a("/login-docente")},D=()=>{b(!0),h(!1)},$=()=>{b(!1)};t.useEffect(()=>{const w=p=>{j.current&&!j.current.contains(p.target)&&h(!1)};return document.addEventListener("mousedown",w),()=>{document.removeEventListener("mousedown",w)}},[]);const A=()=>{h(!u)};t.useEffect(()=>{u&&!v&&(async()=>{try{N(!0);const p=s?.programa_id;if(p==null)return;const{data:r}=await T.get(M.programas.base);try{console.debug("Programas response payload:",r)}catch{}const C=r?.data?.programa?.[0]?.nombre||r?.data?.programa?.nombre||r?.programa?.[0]?.nombre||r?.programa?.nombre||r?.data?.programas?.[0]?.nombre||r?.data?.nombre||r?.nombre||null;C&&y(String(C))}catch{}finally{N(!1)}})()},[u,v,s]);const O=s?.programa_id!==null&&s?.programa_id!==void 0&&(v||s?.programa?.nombre||s?.programa)||null;return console.log(v),o.jsxs(o.Fragment,{children:[o.jsx("nav",{className:e.navbar,children:o.jsxs("div",{className:e.container,children:[o.jsx("button",{className:e.menuButton,onClick:()=>d(!0),"aria-label":"Abrir menú",children:o.jsx(go,{})}),o.jsx("div",{className:e.branding,children:o.jsx("img",{src:"/logo.svg",alt:"Logo",className:e.logo})}),o.jsxs("div",{className:e.userSection,children:[x&&o.jsxs("button",{className:e.roleButton,onClick:()=>a("/admin"),title:"Panel de Administrador",children:[o.jsx(V,{}),o.jsx("span",{children:"Admin"})]}),c&&o.jsxs("button",{className:e.roleButton,onClick:()=>a("/tester"),title:"Panel de Tester",children:[o.jsx(W,{}),o.jsx("span",{children:"Tester"})]}),o.jsxs("div",{className:e.dropdownContainer,ref:j,children:[o.jsxs("button",{onClick:A,className:e.userDropdownButton,title:"Menú de usuario",children:[o.jsx(f,{className:e.userDropdownIcon}),o.jsx(K,{className:`${e.dropdownArrow} ${u?e.rotated:""}`})]}),u&&o.jsxs("div",{className:e.dropdownMenu,children:[o.jsx("div",{className:e.dropdownHeader,children:o.jsx("div",{className:e.userInfo,children:o.jsxs("div",{className:e.userDataRow,children:[o.jsxs("div",{className:e.iconColumn,children:[o.jsx(f,{className:e.userInfoIcon}),o.jsx(Q,{className:e.userInfoIcon}),o.jsx(X,{className:e.userInfoIcon}),o.jsx(Y,{className:e.userInfoIcon})]}),o.jsxs("div",{className:e.dataColumn,children:[o.jsx("span",{className:e.userNameText,children:s?.nombre}),o.jsx("span",{className:e.userEmailText,children:s?.email}),o.jsx("span",{className:e.userEmailText,children:k?"Cargando programa…":O||"Sin programa"}),o.jsx("span",{className:e.userRoleText,children:m})]})]})})}),o.jsx("div",{className:e.dropdownDivider}),o.jsxs("button",{onClick:D,className:e.dropdownLogoutButton,children:[o.jsx(Z,{}),o.jsx("span",{children:"Cerrar sesión"})]})]})]})]})]})}),S&&o.jsx("div",{className:e.modalOverlay,children:o.jsxs("div",{className:e.modalContainer,children:[o.jsxs("div",{className:e.modalHeader,children:[o.jsx(oo,{className:e.modalIcon}),o.jsx("h3",{children:"Confirmar cierre de sesión"})]}),o.jsxs("div",{className:e.modalBody,children:[o.jsx("p",{children:"¿Estás seguro de que deseas cerrar sesión?"}),o.jsx("p",{className:e.modalSubtext,children:"Serás redirigido a la página de inicio de sesión."})]}),o.jsxs("div",{className:e.modalActions,children:[o.jsx("button",{onClick:L,className:e.modalConfirmButton,children:"Cerrar sesión"}),o.jsx("button",{onClick:$,className:e.modalCancelButton,children:"Cancelar"})]})]})})]})},Xo="_layout_x9dnt_1",Yo="_mainContainer_x9dnt_8",Zo="_expanded_x9dnt_18",oe="_collapsed_x9dnt_23",ee="_main_x9dnt_8",se="_overlay_x9dnt_41",ne="_show_x9dnt_51",_={layout:Xo,mainContainer:Yo,expanded:Zo,collapsed:oe,main:ee,overlay:se,show:ne},I=t.createContext(void 0),B=()=>{const a=t.useContext(I);if(!a)throw new Error("useSidebar debe ser usado dentro de DashboardLayout");return a},ce=()=>{const[a,s]=t.useState(()=>{try{const x=localStorage.getItem("sidebar_expanded");return x==null?!0:JSON.parse(x)===!0}catch{return!0}}),[l,d]=t.useState(!1);return t.useEffect(()=>{try{localStorage.setItem("sidebar_expanded",JSON.stringify(a))}catch{}},[a]),o.jsx(I.Provider,{value:{isExpanded:a,setIsExpanded:s,mobileOpen:l,setMobileOpen:d},children:o.jsxs("div",{className:_.layout,children:[o.jsx(po,{}),o.jsx("div",{className:`${_.overlay} ${l?_.show:""}`,onClick:()=>d(!1),"aria-hidden":!l}),o.jsxs("div",{className:`${_.mainContainer} ${a?_.expanded:_.collapsed}`,children:[o.jsx(Qo,{}),o.jsx("main",{className:_.main,children:o.jsx(P,{})})]})]})})};export{ce as default,B as useSidebar};
