import{j as e,r as t,S as M,a as be,b as ue,A as pe,e as we}from"./index-DaOhVVWd.js";import{u as ye}from"./useAuthentication-Dn9EKM7N.js";import{G as me}from"./iconBase-Cr-ff6zs.js";function Ne({title:s,docente:i,programa:w,nivel:u}){return e.jsxs("div",{className:"exam-header text-white mt-3 mb-1",children:[e.jsxs("div",{className:"d-none d-md-block",children:[e.jsx("h1",{className:"exam-header-title h6",children:e.jsx("span",{className:"text-white",children:s})}),e.jsxs("div",{className:"exam-header-info",children:[e.jsxs("div",{className:"exam-header-field",children:[e.jsx("span",{className:"exam-header-label",children:"Docente:"}),e.jsx("span",{className:"exam-header-value",children:i})]}),e.jsxs("div",{className:"exam-header-field",children:[e.jsx("span",{className:"exam-header-label",children:"Programa:"}),e.jsx("span",{className:"exam-header-value",children:w})]}),e.jsxs("div",{className:"exam-header-field",children:[e.jsx("span",{className:"exam-header-label",children:"Nivel:"}),e.jsx("span",{className:"exam-header-value",children:u})]})]})]}),e.jsxs("div",{className:"d-block d-md-none",children:[e.jsx("h1",{className:"exam-header-title-mobile",style:{fontSize:"24px",fontWeight:"600",marginBottom:"16px",lineHeight:"1.1"},children:e.jsx("span",{className:"text-white",children:s})}),e.jsxs("div",{className:"exam-header-info",children:[e.jsxs("div",{className:"exam-header-field",children:[e.jsx("span",{className:"exam-header-label",children:"Docente:"}),e.jsx("span",{className:"exam-header-value",children:i})]}),e.jsxs("div",{className:"exam-header-field",children:[e.jsx("span",{className:"exam-header-label",children:"Programa:"}),e.jsx("span",{className:"exam-header-value",children:w})]}),e.jsxs("div",{className:"exam-header-field",children:[e.jsx("span",{className:"exam-header-label",children:"Nivel:"}),e.jsx("span",{className:"exam-header-value",children:u})]})]})]})]})}function Ce({totalQuestions:s,answeredQuestions:i,currentQuestion:w,onQuestionSelect:u}){const d=Array.from({length:s},(l,o)=>o+1),m=l=>l===1?!0:i.includes(l-1);return e.jsxs("div",{className:"bg-white rounded-3 p-3 p-md-4 shadow-sm question-navigation-mobile-hidden",style:{margin:"0"},children:[e.jsx("h5",{className:"mb-3 text-dark",children:"Navegación del Cuestionario"}),e.jsx("hr",{className:"mb-3",style:{borderColor:"#dee2e6",borderWidth:"1px"}}),e.jsx("div",{className:"d-flex flex-wrap gap-1 gap-md-2 justify-content-center",children:d.map(l=>{const o=i.includes(l),b=m(l),_=l===w;return e.jsx("button",{className:`btn btn-sm rounded-2 d-flex align-items-center justify-content-center ${o?"text-white":b?"btn-outline-success":"btn-outline-secondary"}`,style:{backgroundColor:_?"#8BD8BF":o?"#78bda7":b?"#F8FAFC":"#C7CBD1",borderColor:_?"#6ba89c":o?"#5a9b85":b?"#e2e6ea":"#a8b0b8",width:"36px",height:"36px",color:_?"white":o?"black":b?"#6c757d":"#adb5bd",cursor:b?"pointer":"not-allowed",opacity:b?1:.7,borderWidth:"1px",fontSize:"12px"},onClick:()=>b&&u(l),disabled:!b,children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center gap-1",children:[e.jsx("span",{children:l}),o&&e.jsx("svg",{width:"4",height:"4",viewBox:"0 0 24 24",fill:"currentColor",style:{marginLeft:"3px"},children:e.jsx("circle",{cx:"12",cy:"12",r:"12"})}),!b&&l>1&&e.jsx("svg",{width:"8",height:"8",viewBox:"0 0 24 24",fill:"currentColor",style:{marginLeft:"2px"},children:e.jsx("path",{d:"M18,8h-1V6c0-2.76-2.24-5-5-5S7,3.24,7,6v2H6c-1.1,0-2,0.9-2,2v10c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2V10C20,8.9,19.1,8,18,8z M12,17c-1.1,0-2-0.9-2-2s0.9-2,2-2s2,0.9,2,2S13.1,17,12,17z M15.1,8H8.9V6c0-1.71,1.39-3.1,3.1-3.1s3.1,1.39,3.1,3.1V8z"})})]})},l)})})]})}function ke({timeRemaining:s,timePercent:i,progress:w}){const u=t.useRef(null),d=t.useRef(null),[m,l]=t.useState(!1),o=i<=25?"#ef4444":i<=50?"#f1995a":"#10b981",b=100-i;t.useEffect(()=>{if(!d.current)return;const n=new IntersectionObserver(([x])=>{l(!x.isIntersecting)},{root:null,threshold:0});return n.observe(d.current),()=>n.disconnect()},[]),t.useEffect(()=>{const n="questiondisplay-alert-animations";if(!document.getElementById(n)){const x=document.createElement("style");x.id=n,x.innerHTML=`
        @keyframes timer-alert-enter { from { opacity: 0; transform: translateX(8px) scale(0.98); } to { opacity: 1; transform: translateX(0) scale(1); } }
        @keyframes timer-alert-pulse { 0% { transform: translateX(0) scale(1); } 50% { transform: translateX(0) scale(1.03); } 100% { transform: translateX(0) scale(1); } }
      `,document.head.appendChild(x)}},[]);const _=i<=10?"critical":i<=25?"low":i<=50?"mid":"none";return e.jsxs("div",{ref:u,className:"bg-white rounded-3 p-3 p-md-4 shadow-sm",style:{margin:"0",overflow:"visible",position:"relative"},children:[e.jsx("div",{ref:d,className:"d-block d-md-none",style:{position:"absolute",top:0,left:0,width:1,height:1}}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsx("h6",{className:"mb-0 text-dark",style:{fontWeight:600},children:"Progreso del cuestionario"}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[i<=50&&e.jsx("div",{className:"d-block d-md-none",style:m?{position:"fixed",right:92,top:30,zIndex:1090}:{position:"relative"},children:e.jsxs("div",{style:{position:"relative",backgroundColor:o,color:"#fff",padding:"6px 10px",borderRadius:8,fontSize:13,fontWeight:600,boxShadow:"0 6px 16px rgba(0,0,0,0.12)",animation:"timer-alert-enter 220ms ease-out, timer-alert-pulse 1600ms ease-in-out 220ms infinite",willChange:"transform, opacity"},children:[i<=10?"Tiempo crítico":i<=25?"Queda poco tiempo":"Mitad del cuestionario",e.jsx("span",{"aria-hidden":!0,style:{position:"absolute",right:-8,top:"50%",transform:"translateY(-50%)",width:0,height:0,borderTop:"8px solid transparent",borderBottom:"8px solid transparent",borderLeft:`8px solid ${o}`}})]})},`mob-alert-${_}`),e.jsx("div",{className:"d-flex d-md-none",style:m?{position:"fixed",top:12,right:12,zIndex:1100}:{position:"relative"},children:e.jsx("div",{style:{color:"white",display:"flex",alignItems:"center",justifyContent:"center",width:72,height:72,borderRadius:"50%",background:`conic-gradient(rgba(0,0,0,0.18) ${b}%, rgba(0,0,0,0.06) 0)`},"aria-label":`Tiempo restante ${s}`,title:`Tiempo restante ${s}`,children:e.jsxs("div",{style:{width:64,height:64,borderRadius:"50%",backgroundColor:o,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:2,boxShadow:"inset 0 0 0 2px rgba(255,255,255,0.15)"},children:[e.jsx("i",{className:"bi bi-stopwatch","aria-hidden":"true",style:{fontSize:16,lineHeight:1,color:"#ffffff"}}),e.jsx("span",{style:{fontSize:16,lineHeight:1,fontWeight:800,color:"#ffffff"},children:s})]})})}),m&&e.jsx("div",{className:"d-block d-md-none",style:{width:i<=50?170:80}})]})]}),m&&e.jsx("div",{className:"d-block d-md-none",style:{height:84}}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"progress position-relative",style:{height:"20px"},children:[e.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${w}%`,backgroundColor:"#8bd8bf"}}),e.jsxs("small",{className:"position-absolute w-100 text-center text-muted",style:{top:"50%",transform:"translateY(-50%)",fontSize:"14px",fontWeight:"600"},children:[w,"%"]})]})})]})}const Se="_imageContainer_1mtic_7",Ie="_examContainer_1mtic_29",_e="_examHeader_1mtic_36",Te="_examNavigation_1mtic_40",Ae="_examQuestion_1mtic_44",Ee="_examAnswers_1mtic_48",Re="_examButtons_1mtic_52",Me="_componentCard_1mtic_61",We="_questionImageResponsive_1mtic_130",ze="_optionContainer_1mtic_150",$e="_optionImageTopRight_1mtic_158",Pe="_optionTextWithImage_1mtic_176",k={imageContainer:Se,examContainer:Ie,examHeader:_e,examNavigation:Te,examQuestion:Ae,examAnswers:Ee,examButtons:Re,componentCard:Me,questionImageResponsive:We,optionContainer:ze,optionImageTopRight:$e,optionTextWithImage:Pe};function De({answers:s,selectedAnswer:i,onAnswerSelect:w,questionText:u,weight:d,questionImage:m,onImageClick:l,orientation:o=1,currentQuestion:b}){return o===0?e.jsxs("div",{className:"col-12",children:[e.jsxs("div",{className:"d-flex flex-row flex-md-row justify-content-between align-items-center mb-2",children:[e.jsxs("h5",{className:"mb-0 text-dark d-none d-md-block",children:["Pregunta ",b]}),e.jsxs("span",{className:"badge text-white d-none d-md-inline-block",style:{backgroundColor:"#2C3E50",color:"white",whiteSpace:"nowrap",zIndex:2},"aria-label":`Peso de la pregunta: ${d}`,children:["Peso: ",d]})]}),e.jsxs("div",{className:"row g-4",children:[e.jsxs("div",{className:"d-block d-md-none",children:[e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"d-block d-md-none",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsxs("h6",{className:"mb-0 text-dark",children:["Pregunta ",b]}),e.jsxs("span",{className:"badge text-white",style:{backgroundColor:"#2C3E50",color:"white",whiteSpace:"nowrap"},children:["Peso: ",d]})]}),e.jsx("p",{className:"text-dark lh-base mb-0",style:{fontWeight:"500"},children:u})]})}),m&&e.jsx("div",{className:`mt-3 mb-3 ${k.imageContainer}`,children:e.jsx("img",{src:m,alt:"Imagen de la pregunta",className:k.questionImageResponsive,onClick:()=>l&&l(m),title:"Click para ampliar imagen"})}),e.jsx("hr",{className:"mt-3 mb-0",style:{borderColor:"#dee2e6",borderWidth:"1px"}})]}),e.jsx("div",{className:"mb-3",children:e.jsx("span",{children:"Opciones de respuesta"})}),s.map(n=>e.jsx("div",{className:"col-12 mb-3",children:e.jsxs("div",{className:`p-2 p-md-3 rounded-3 border cursor-pointer m-auto ${i===n.id?"border-success":"border-secondary"} ${k.optionContainer}`,style:{backgroundColor:i===n.id?"#d4edda":"#ffffff",cursor:"pointer",borderWidth:"2px"},onClick:()=>w(n.id),children:[n.imagen&&e.jsx("img",{src:n.imagen,alt:`Imagen de la opción ${n.id}`,className:k.optionImageTopRight,onClick:x=>{x.stopPropagation(),l&&l(n.imagen)},title:"Click para ampliar imagen"}),e.jsxs("div",{className:"d-flex align-items-start gap-3",children:[e.jsx("span",{className:"rounded-circle d-flex align-items-center justify-content-center flex-shrink-0",style:{width:"32px",height:"32px",fontSize:"14px",backgroundColor:i===n.id?"#28a745":"#F1995A",border:i===n.id?"2px solid #28a745":"2px solid #F1995A",color:"white",fontWeight:"600",objectFit:"cover",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",minHeight:"32px"},children:n.id}),e.jsx("div",{className:`flex-grow-1 ${n.imagen?k.optionTextWithImage:""}`,children:e.jsx("span",{className:"text-dark d-block",style:{fontSize:"15px",lineHeight:"1.4"},children:n.text})})]})]})},n.id))]}),e.jsxs("div",{className:"d-none d-md-flex justify-content-between align-items-start w-100",children:[e.jsxs("div",{className:"pe-3",style:{flex:"0 0 58%"},children:[e.jsx("div",{className:"mb-3 d-flex justify-content-between align-items-start",children:e.jsx("p",{className:"text-dark lh-base mb-0",style:{flex:1,marginRight:"16px",fontWeight:"500"},children:u})}),m&&e.jsx("div",{className:`mt-3 ${k.imageContainer}`,children:e.jsx("img",{src:m,alt:"Imagen de la pregunta",className:k.questionImageResponsive,onClick:()=>l&&l(m),title:"Click para ampliar imagen"})})]}),e.jsxs("div",{className:"ps-3",style:{flex:"0 0 40%"},children:[e.jsx("div",{className:"mb-3 text-end",children:e.jsx("span",{children:"Opciones de respuesta"})}),e.jsx("div",{className:"row g-3",children:s.map(n=>e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:`p-2 p-md-3 rounded-3 border cursor-pointer ${i===n.id?"border-success":"border-secondary"} ${k.optionContainer}`,style:{backgroundColor:i===n.id?"#d4edda":"#ffffff",cursor:"pointer",borderWidth:"2px"},onClick:()=>w(n.id),children:[n.imagen&&e.jsx("img",{src:n.imagen,alt:`Imagen de la opción ${n.id}`,className:k.optionImageTopRight,onClick:x=>{x.stopPropagation(),l&&l(n.imagen)},title:"Click para ampliar imagen"}),e.jsxs("div",{className:"d-flex align-items-start gap-3",children:[e.jsx("span",{className:"rounded-circle d-flex align-items-center justify-content-center flex-shrink-0",style:{width:"32px",height:"32px",fontSize:"14px",backgroundColor:i===n.id?"#28a745":"#F1995A",border:i===n.id?"2px solid #28a745":"2px solid #F1995A",color:"white",fontWeight:"600",objectFit:"cover",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",minHeight:"32px"},children:n.id}),e.jsx("div",{className:`flex-grow-1 ${n.imagen?k.optionTextWithImage:""}`,children:e.jsx("span",{className:"text-dark d-block",style:{fontSize:"15px",lineHeight:"1.4"},children:n.text})})]})]})},n.id))})]})]})]})]}):e.jsxs("div",{className:"row g-3 justify-content-center",children:[e.jsxs("div",{className:"col-12 mb-2 d-flex justify-content-between align-items-center",children:[e.jsxs("h5",{className:"mb-0 text-dark d-none d-md-block",children:["Pregunta ",b]}),e.jsxs("span",{className:"badge text-white d-none d-md-inline-block",style:{backgroundColor:"#2C3E50",color:"white",whiteSpace:"nowrap"},children:["Peso: ",d]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-block d-md-none",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsxs("h6",{className:"mb-0 text-dark",children:["Pregunta ",b]}),e.jsxs("span",{className:"badge text-white",style:{backgroundColor:"#2C3E50",color:"white",whiteSpace:"nowrap"},children:["Peso: ",d]})]}),e.jsx("p",{className:"text-dark lh-base mb-0",style:{fontWeight:"500"},children:u})]}),e.jsx("div",{className:"d-none d-md-flex justify-content-between align-items-start",children:e.jsx("p",{className:"text-dark lh-base mb-0",style:{flex:1,marginRight:"16px",fontWeight:"500"},children:u})})]}),m&&e.jsx("div",{className:`mt-3 mb-3 ${k.imageContainer}`,children:e.jsx("img",{src:m,alt:"Imagen de la pregunta",className:k.questionImageResponsive,onClick:()=>l&&l(m),title:"Click para ampliar imagen"})}),e.jsx("hr",{className:"mt-3 mb-0",style:{borderColor:"#dee2e6",borderWidth:"1px"}})]}),e.jsx("div",{className:"mb-3",children:e.jsx("span",{children:"Opciones de respuesta"})}),s.map(n=>e.jsx("div",{className:"col-12 col-md-6",children:e.jsxs("div",{className:`p-2 p-md-3 rounded-3 border cursor-pointer m-auto ${i===n.id?"border-success":"border-secondary"} ${k.optionContainer}`,style:{backgroundColor:i===n.id?"#d4edda":"#ffffff",cursor:"pointer",borderWidth:"2px"},onClick:()=>w(n.id),children:[n.imagen&&e.jsx("img",{src:n.imagen,alt:`Imagen de la opción ${n.id}`,className:k.optionImageTopRight,onClick:x=>{x.stopPropagation(),l&&l(n.imagen)},title:"Click para ampliar imagen"}),e.jsxs("div",{className:"d-flex align-items-start gap-3",children:[e.jsx("span",{className:"rounded-circle d-flex align-items-center justify-content-center flex-shrink-0",style:{width:"32px",height:"32px",fontSize:"14px",backgroundColor:i===n.id?"#28a745":"#F1995A",border:i===n.id?"2px solid #28a745":"2px solid #F1995A",color:"white",fontWeight:"600",objectFit:"cover",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",minHeight:"32px"},children:n.id}),e.jsx("div",{className:`flex-grow-1 ${n.imagen?k.optionTextWithImage:""}`,children:e.jsx("span",{className:"text-dark d-block",style:{fontSize:"15px",lineHeight:"1.4"},children:n.text})})]})]})},n.id))]})}function Be({currentQuestion:s,onPrevious:i,onNext:w,isLastPage:u=!1,onSubmit:d,isSubmitting:m=!1}){const l=()=>{u&&d?d():w()};return e.jsxs("div",{className:"d-flex justify-content-between gap-2",style:{margin:"0"},children:[e.jsx("button",{className:"btn btn-secondary px-3 px-md-4 py-2 flex-grow-1 flex-md-grow-0",disabled:s===1,onClick:i,style:{maxWidth:"150px"},children:"Anterior"}),e.jsx("button",{className:"btn text-white px-3 px-md-4 py-2 flex-grow-1 flex-md-grow-0",style:{backgroundColor:"#2c3e50",maxWidth:"150px"},onClick:l,disabled:m,children:m?"Enviando...":u?"Finalizar":"Siguiente"})]})}const z={normal:"normal",warning:"warning",danger:"danger"},Le=({preguntas:s,cuestionario:i,isLoading:w,onTimeUp:u,elapsedMs:d=0})=>{const m=t.useCallback(()=>`examTimer:${(i?.id||(typeof window<"u"?window.location.pathname.split("/").pop():"unknown"))??"unknown"}`,[i]),l=()=>typeof window>"u"?!1:window.innerWidth>=768,[o,b]=t.useState(3600),[_,n]=t.useState(3600),[x,y]=t.useState(0),[T,W]=t.useState(z.normal),[F,G]=t.useState(!1),Y=t.useRef(!1),J=t.useRef(0),ne=t.useRef(u);t.useEffect(()=>{ne.current=u},[u]);const ae=t.useCallback(f=>{if(!f)return 0;if(typeof f=="number")return f;if(typeof f=="string"){const p=f.split(":").map(h=>parseInt(h,10));if(p.length===3){const[h,N,R]=p;return h*3600+N*60+R}else if(p.length===2){const[h,N]=p;return h*60+N}}return 0},[]);t.useEffect(()=>{if(!i?.tiempo_limite){console.log("⚠️ No hay tiempo_limite en el cuestionario, usando tiempo por defecto");return}const f=i.tiempo_limite,p=ae(f);console.log(`✅ TIEMPO_LIMITE OBTENIDO DEL CUESTIONARIO: "${f}" → ${p} segundos (${Math.floor(p/60)} minutos)`),p>0?(b(p),n(p)):console.log("⚠️ Tiempo convertido es 0, usando tiempo por defecto")},[i?.tiempo_limite,ae]);const K=t.useCallback(f=>{const p=f/o*100;return p<=25?z.danger:p<=50?z.warning:z.normal},[o]),D=t.useCallback(f=>{l()&&(f===z.warning?M.fire({position:"top-end",icon:"warning",title:"⏰ Tiempo: Mitad del cuestionario",text:"Te queda la mitad del tiempo disponible",toast:!0,showConfirmButton:!1,timer:4e3,timerProgressBar:!0,didOpen:p=>{p.addEventListener("mouseenter",M.stopTimer),p.addEventListener("mouseleave",M.resumeTimer)},customClass:{popup:"swal-warning-toast"}}):f===z.danger&&M.fire({position:"top-end",icon:"error",title:"🚨 Tiempo crítico: Últimos minutos",text:"Apúrate, te queda poco tiempo",toast:!0,showConfirmButton:!1,timer:5e3,timerProgressBar:!0,didOpen:p=>{p.addEventListener("mouseenter",M.stopTimer),p.addEventListener("mouseleave",M.resumeTimer)},customClass:{popup:"swal-danger-toast"}}))},[]),E=t.useCallback(f=>{const p=Math.floor(f/60),h=f%60;return`${p}:${h<10?"0":""}${h}`},[]),B=t.useCallback(f=>{const p=_/o*100;return p<=25?`${f.timer} ${f.timerDanger}`:p<=50?`${f.timer} ${f.timerWarning}`:f.timer},[_,o]),re=t.useCallback(()=>{const f=(o-_)/o*100;let p="";if(f<=0)p="polygon(50% 50%, 50% 0%, 50% 0%, 50% 0%)";else if(f>=100)p="circle(50% at 50% 50%)";else{const h=[];h.push("50% 50%"),h.push("50% 0%");const N=f/100*360,R=36,C=Math.ceil(N/360*R);for(let H=1;H<=C;H++){const le=H/R*2*Math.PI,oe=50+50*Math.sin(le),v=50-50*Math.cos(le);h.push(`${oe.toFixed(1)}% ${v.toFixed(1)}%`)}p=`polygon(${h.join(", ")})`}return{clipPath:p}},[_,o]),O=t.useCallback(()=>{console.log(`🚀 Iniciando temporizador con ${o} segundos (${Math.floor(o/60)} minutos)`);try{const f=typeof window<"u"?localStorage.getItem(m()):null;if(f){const p=JSON.parse(f),h=typeof p?.remaining=="number"?Math.max(0,Math.min(o,p.remaining)):null;if(h!==null){n(h);const N=o-h;y(Date.now()-N*1e3)}else n(o),y(Date.now())}else n(o),y(Date.now())}catch{n(o),y(Date.now())}W(z.normal),G(!1),Y.current=!1,J.current=0},[o,m]),L=t.useCallback(()=>{n(o),y(0),W(z.normal),G(!1);try{typeof window<"u"&&localStorage.removeItem(m())}catch{}},[o]),ie=t.useCallback(()=>{if(d>0&&o>0){const f=Math.max(0,o-Math.floor(d/1e3));n(f);const p=Date.now()-d;y(p),console.log(`🔄 Timer configurado por restauración: ${d}ms transcurridos, ${f}s restantes`)}},[d,o]);return t.useEffect(()=>{if(w||!i||x===0)return;const f=setInterval(()=>{const p=Date.now(),h=Math.floor((p-x)/1e3),N=Math.max(0,o-h),R=K(N);R!==T&&(R===z.warning&&T===z.normal?D(z.warning):R===z.danger&&T===z.warning&&D(z.danger),W(R)),N<=60&&N>55&&!F&&(G(!0),l()&&M.fire({position:"top-end",icon:"warning",title:"🚨 ¡Último minuto!",text:"Solo te queda 1 minuto para terminar",toast:!0,showConfirmButton:!1,timer:6e3,timerProgressBar:!0,didOpen:C=>{C.addEventListener("mouseenter",M.stopTimer),C.addEventListener("mouseleave",M.resumeTimer)},customClass:{popup:"swal-final-warning"}})),n(N);try{typeof window<"u"&&(!J.current||p-J.current>=1e3)&&(localStorage.setItem(m(),JSON.stringify({total:o,remaining:N,savedAt:p})),J.current=p)}catch{}if(N<=0&&!Y.current){clearInterval(f),Y.current=!0;try{typeof window<"u"&&localStorage.removeItem(m())}catch{}M.fire({position:"center",icon:"info",title:"⏰ Tiempo agotado",text:"El tiempo ha terminado. Enviando tu cuestionario...",toast:!1,showConfirmButton:!1,timer:2e3,timerProgressBar:!0,allowOutsideClick:!1,customClass:{popup:"swal-time-up"}}).then(()=>{ne.current&&ne.current()})}},100);return()=>clearInterval(f)},[w,i,x,o,T,F,K,D]),t.useEffect(()=>{},[s.length,i,x]),t.useEffect(()=>{d>0&&o>0&&ie()},[d,o,ie]),{tiempoRestante:_,tiempoTotalCuestionario:o,formatearTiempo:E,getTimerClass:B,getTimerProgressStyle:re,iniciarTimer:O,resetTimer:L,configurarTimer:ie}},Fe=({preguntas:s,respuestas:i,preguntasPorPagina:w=1})=>{const[u,d]=t.useState(1),m=t.useMemo(()=>{const x=Math.ceil(s.length/w),y=(u-1)*w,T=y+w,W=s.slice(y,T),F=Object.keys(i).length,G=Math.round(F/s.length*100);return{totalPaginas:x,indiceInicio:y,indiceFin:T,preguntasActuales:W,preguntasRespondidas:F,porcentajeCompletado:G}},[s,u,w,i]),l=t.useCallback(x=>{if(x===1)return!1;const y=s[x-1]?.id;if(i.hasOwnProperty(y))return!1;const T=s[x-2]?.id;return!i.hasOwnProperty(T)},[s,i]),o=t.useCallback(x=>{x<1||x>m.totalPaginas||l(x)||(d(x),window.scrollTo({top:0,behavior:"smooth"}))},[m.totalPaginas,l]),b=t.useCallback(()=>{o(u+1)},[u,o]),_=t.useCallback(()=>{o(u-1)},[u,o]),n=t.useMemo(()=>{const x=u===1,y=u===m.totalPaginas,T=!x,W=!y&&!l(u+1);return{isFirstPage:x,isLastPage:y,canNavigatePrevious:T,canNavigateNext:W}},[u,m.totalPaginas,l]);return{paginaActual:u,...m,cambiarPagina:o,irSiguiente:b,irAnterior:_,isPreguntaBloqueada:l,...n}},Oe=({cuestionarioId:s})=>{const i=be(),{isAuthenticated:w,user:u}=ye(),[d,m]=t.useState(null),[l,o]=t.useState([]),[b,_]=t.useState({}),[n,x]=t.useState(0),[y,T]=t.useState(null),[W,F]=t.useState(!0),[G,Y]=t.useState(null),[J,ne]=t.useState(!1),ae=t.useRef(!1),K=t.useRef(!1),D=t.useRef(!1),E=t.useRef(null),B=t.useRef(0),re=t.useRef(!1),O=t.useRef(null),[L,ie]=t.useState(!0),f=t.useCallback((v,j)=>{if(!j)return"";const I=Number(j);return`http://localhost/cuestionario-api/api/obtenerImagen_api.php?tipo=${encodeURIComponent(v)}&id=${encodeURIComponent(String(I))}`},[]),p=typeof window<"u"?localStorage.getItem("rol"):null,h=u?.rol==="estudiante"||u?.rol==="2"||p==="2",N=t.useCallback(()=>{if(!h)return null;const v=typeof window<"u"?localStorage.getItem("user"):null,j=v?JSON.parse(v)?.id:void 0,I=u?.id??j;return I&&s?`quiz_progress:${I}:${s}`:null},[u?.id,s,h]),R=t.useCallback(()=>{const v=N();if(!v)return null;try{const j=localStorage.getItem(v);return j?JSON.parse(j):null}catch{return null}},[N]),C=t.useCallback(v=>{const j=N();if(!j)return;const I=R()||{answers:{},elapsedMs:0,startedAt:Date.now()},g={answers:v.answers??I.answers,elapsedMs:v.elapsedMs??I.elapsedMs,startedAt:v.startedAt??I.startedAt,lastUpdated:Date.now()};localStorage.setItem(j,JSON.stringify(g))},[N,R]),H=t.useCallback(()=>{const v=N();v&&localStorage.removeItem(v)},[N]),le=t.useCallback((v,j)=>{_(I=>{const g={...I,[v]:j},S=Date.now();return S-B.current>500&&(C({answers:g}),B.current=S),g})},[C]),oe=t.useCallback(async v=>{if(J||ae.current||!s)return;const j=l.length,I=Object.keys(b).length;if(!v?.forceIncomplete&&I<j){await M.fire({icon:"warning",title:"Faltan respuestas",text:"Por favor responde todas las preguntas antes de enviar.",confirmButtonText:"Entendido"});return}if(!(!v?.skipConfirm&&!(await M.fire({title:"¿Enviar respuestas?",text:"Una vez enviadas, no podrás modificar tus respuestas.",icon:"question",showCancelButton:!0,confirmButtonText:"Enviar",cancelButtonText:"Cancelar"})).isConfirmed))try{ne(!0),ae.current=!0;const g=l.map(V=>({pregunta_id:Number(V.id),opcion_id:b[V.id]??null})).filter(V=>V.opcion_id!==null&&V.opcion_id!==void 0),S=typeof window<"u"?localStorage.getItem("user"):null,q=S?JSON.parse(S)?.id:void 0,U=u?.id??q,$={estudiante_id:U,respuestas:g,tiempo_utilizado:Math.max(0,Math.floor((n||0)/1e3))};if(console.log("Payload enviado a guardar-intento:",$),console.log("Contenido de respuestas:",g,"Total:",g.length),!v?.forceIncomplete&&(!g||g.length===0)){await M.fire({icon:"warning",title:"Faltan respuestas",text:"Debes responder al menos una pregunta antes de enviar.",confirmButtonText:"Entendido"});return}if(!U){await M.fire({icon:"error",title:"Error",text:"No se pudo identificar al estudiante. Inicia sesión nuevamente.",confirmButtonText:"Entendido"});return}const ee=await ue.post(`${pe.cuestionario.resolver.guardarIntento(s)}`,$);if(!ee||ee.data.error){if(ee?.data?.error?.includes("sesión")||ee?.data?.error?.includes("acceso")){window.location.href="/login-estudiante";return}throw new Error(ee?.data?.error||"Error al enviar respuestas")}await M.fire({icon:"success",title:"¡Listo!",text:"Tus respuestas fueron enviadas correctamente.",confirmButtonText:"Ver resultados"}),D.current||(D.current=!0,i(`/resultado/${s}`)),H()}catch(g){console.error("Error al enviar cuestionario:",g);const S=g;S?.response?.data&&console.error("Respuesta del backend:",S.response.data),await M.fire({icon:"error",title:"Error",text:"No se pudo enviar el cuestionario.",confirmButtonText:"Volver a intentar"})}finally{ne(!1),ae.current=!1}},[J,s,l.length,l,b,i,u?.id,H]);return t.useEffect(()=>!L||K.current?void 0:((async()=>{if(K.current=!0,!s||isNaN(Number(s))){Y("ID de cuestionario no válido"),F(!1),K.current=!1;return}const j=typeof window<"u"?localStorage.getItem("token"):null;if(!(w||!!j)||!h){Y("Debes iniciar sesión como estudiante para resolver el cuestionario."),F(!1);return}try{const g=await ue.get(`${pe.cuestionario.resolver.preguntasOpciones(s)}`);console.log("[realizar] preguntas-opciones raw:",g?.data);let S=g?.data?.cuestionario??g?.data?.data?.cuestionario??g?.data?.cuestionario_info??null,q=Array.isArray(g?.data?.data)?g?.data?.data:g?.data?.preguntas??g?.data?.data?.preguntas??g?.data?.preguntas_opciones??g?.data?.data?.preguntas_opciones??[];if(!S||Array.isArray(q)&&q.length===0)try{const Q=await ue.get(`${pe.cuestionario.resolver.verificar(s)}`);console.log("[realizar] base raw:",Q?.data),S=(Q?.data?.data??Q?.data??{})?.cuestionario??S,console.log("[realizar] cuestionario extraído:",S),console.log("[realizar] tiempo_limite extraído:",S?.tiempo_limite);const se=Q?.data?.preguntas??Q?.data?.data?.preguntas??[];Array.isArray(se)&&se.length>0&&(q=se)}catch(Q){console.warn("[realizar] fallback /cuestionario/:id falló",Q)}if(!L)return;const U=g?.data?.error||void 0;if(!Array.isArray(q)||q.length===0||U)throw U?.includes("sesión")||U?.includes("acceso")?(Y("Tu sesión no es válida o no tienes acceso a este cuestionario."),new Error(U||"Sesión inválida o sin acceso")):new Error(U||"Cuestionario no disponible");const ee=(Q=>(Q||[]).map((A,se)=>{const a=((Array.isArray(A?.opciones)?A.opciones:Array.isArray(A?.opcion)?A.opcion:Array.isArray(A?.opciones_pregunta)?A.opciones_pregunta:Array.isArray(A?.opcionesPregunta)?A.opcionesPregunta:[])||[]).map((c,Z)=>{const X=Number(c?.id??c?.opcion_id??c?.id_opcion??Z+1);return{...c,id:X,opcion_id:Number(c?.opcion_id??c?.id_opcion??X)}}),r=Number(A?.id??A?.pregunta_id??A?.id_pregunta??se+1);return{...A,id:r,pregunta_id:Number(A?.pregunta_id??A?.id_pregunta??r),opciones:a}}))(Array.isArray(q)?q:[]);m(S??null),o(ee);const V=Number(S?.tiempo_limite);!isNaN(V)&&V>0?T(V*60*1e3):T(null);const P=R();P?(P.answers&&Object.keys(P.answers).length>0&&_(P.answers),typeof P.elapsedMs=="number"&&P.elapsedMs>=0&&x(P.elapsedMs),typeof P.startedAt=="number"&&P.startedAt>0?O.current=P.startedAt:(O.current=Date.now()-(P.elapsedMs||0),C({startedAt:O.current}))):(O.current=Date.now(),C({startedAt:O.current,elapsedMs:0,answers:{}}))}catch(g){if(!L)return;const S=g instanceof Error?g.message:"Error al cargar el cuestionario";Y(S),console.error("Error al cargar cuestionario:",g)}finally{L&&F(!1)}})().finally(()=>{K.current=!1}),E.current&&window.clearInterval(E.current),h&&(E.current=window.setInterval(()=>{const j=O.current??Date.now();let g=Date.now()-j;y&&g>=y&&(g=y,E.current&&(window.clearInterval(E.current),E.current=null)),x(g),C({elapsedMs:g})},1e3)),()=>{ie(!1),E.current&&(window.clearInterval(E.current),E.current=null)}),[s,w,u?.rol,L,i,u?.id,R,C,y,h]),t.useEffect(()=>{if(!h&&typeof window<"u"){const v=[];for(let j=0;j<localStorage.length;j++){const I=localStorage.key(j);I&&I.startsWith("quiz_progress:")&&v.push(I)}v.forEach(j=>localStorage.removeItem(j))}},[h]),t.useEffect(()=>{y&&(re.current||n>=y&&(re.current=!0,oe({forceIncomplete:!0,skipConfirm:!0})))},[n,y,oe]),{cuestionario:d,preguntas:l,respuestas:b,elapsedMs:n,isLoading:W,error:G,handleChange:le,handleSubmit:oe,getImageUrl:f,isSubmitting:J}};function He(s){return me({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"5 9 2 12 5 15"},child:[]},{tag:"polyline",attr:{points:"9 5 12 2 15 5"},child:[]},{tag:"polyline",attr:{points:"15 19 12 22 9 19"},child:[]},{tag:"polyline",attr:{points:"19 9 22 12 19 15"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"22"},child:[]}]})(s)}function qe(s){return me({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"6"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"2"},child:[]}]})(s)}function Ue(s){return me({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(s)}function he(s){return me({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]},{tag:"line",attr:{x1:"11",y1:"8",x2:"11",y2:"14"},child:[]},{tag:"line",attr:{x1:"8",y1:"11",x2:"14",y2:"11"},child:[]}]})(s)}function Ve(s){return me({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]},{tag:"line",attr:{x1:"8",y1:"11",x2:"14",y2:"11"},child:[]}]})(s)}function Qe(){const s=we(),i=be(),w=s.id,{user:u}=ye(),{cuestionario:d,preguntas:m,respuestas:l,isLoading:o,error:b,handleChange:_,handleSubmit:n,isSubmitting:x,elapsedMs:y}=Oe({cuestionarioId:w}),{paginaActual:T,preguntasActuales:W,porcentajeCompletado:F,cambiarPagina:G,irSiguiente:Y,irAnterior:J,isLastPage:ne,canNavigateNext:ae,canNavigatePrevious:K}=Fe({preguntas:m,respuestas:l,preguntasPorPagina:1}),{tiempoRestante:D,tiempoTotalCuestionario:E,formatearTiempo:B,iniciarTimer:re,configurarTimer:O}=Le({preguntas:m,cuestionario:d,isLoading:o,onTimeUp:()=>n({forceIncomplete:!0,skipConfirm:!0}),elapsedMs:y||0}),L=Math.max(0,Math.min(100,Math.round(D/Math.max(1,E)*100))),ie=L<=25?"#ef4444":L<=50?"#f1995a":"#10b981",f=100-L;t.useEffect(()=>{m.length>0&&d&&re()},[m,d,re,y]),t.useEffect(()=>{m.length>0&&d&&y>0&&O()},[y,m,d,O]),t.useEffect(()=>{const a="timer-toast-offset-style";if(!document.getElementById(a)){const c=document.createElement("style");c.id=a,c.innerHTML=`
        /* SweetAlert2: contenedores en esquina superior derecha */
        .swal2-container.swal2-top-end, .swal2-container.swal2-top-right { 
          padding-top: 110px !important; /* altura del timer + margen */
        }
        /* Bootstrap toast container fijo arriba derecha */
        .toast-container.position-fixed.top-0.end-0 { 
          margin-top: 110px !important; 
          z-index: 1000; /* por debajo del timer (1100) */
        }

        /* --- Modo móvil: evitar estorbar al usuario --- */
        @media (max-width: 767.98px) {
          /* Mover SweetAlert2 a la parte inferior y expandir a ancho legible */
          .swal2-container.swal2-top-end, .swal2-container.swal2-top-right {
            padding-top: 0 !important;
            align-items: flex-end !important; /* derecha */
            justify-content: flex-end !important; /* abajo */
            padding: 0 12px 12px 12px !important;
          }
          .swal2-container.swal2-top-end .swal2-popup,
          .swal2-container.swal2-top-right .swal2-popup {
            width: min(440px, calc(100vw - 24px)) !important;
            margin: 0 !important;
            border-radius: 12px !important;
          }

          /* Reubicar toasts de Bootstrap a la parte inferior derecha */
          .toast-container.position-fixed.top-0.end-0 {
            top: auto !important;
            bottom: 12px !important;
            margin-top: 0 !important;
            right: 12px !important;
            z-index: 1000 !important; /* debajo del timer móvil (1100) */
          }
          .toast-container .toast {
            max-width: min(440px, calc(100vw - 24px));
            border-radius: 12px;
          }
        }
      `,document.head.appendChild(c)}return()=>{}},[]);const[p,h]=t.useState(""),[N,R]=t.useState(1),[C,H]=t.useState(null),[le,oe]=t.useState("Docente"),[v,j]=t.useState("Programa"),[I,g]=t.useState("Nivel");t.useEffect(()=>{const a=d?.creador_nombre||d?.docente_nombre||d?.autor||"Docente";oe(String(a));const r=d?.programa_nombre||d?.programa||d?.programa_estudiante||d?.programaAsignado||d?.nombre_programa;r&&j(String(r));const c=d?.nivel_nombre||d?.nivel;c&&g(String(c)),(!r||!c)&&(async()=>{try{const X=u?.programa_id||u?.programa?.id;if(!X)return;const te=(await ue.get(pe.programas.byId(X)))?.data,ce=te?.data?.programa?.nombre||te?.programa?.nombre||te?.nombre||te?.programa_nombre,de=te?.data?.programa?.nivel_nombre||te?.programa?.nivel_nombre||te?.nivel_nombre;!r&&ce&&j(String(ce)),!c&&de&&g(String(de))}catch{}})()},[d,u]),t.useEffect(()=>{const a=r=>{r.key==="Escape"&&C&&H(null)};return C&&(document.addEventListener("keydown",a),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",a),document.body.style.overflow="unset"}},[C]);const S=a=>{if(!a)return null;const r=String(a).trim();if(!r)return null;if(/^data:image\//i.test(r))return r;let c="png";return r.startsWith("/9j")?c="jpeg":r.startsWith("iVBOR")?c="png":r.startsWith("R0lG")?c="gif":r.startsWith("UklGR")?c="webp":r.startsWith("Qk")?c="bmp":(r.startsWith("PHN2Zy")||r.startsWith("PD94"))&&(c="svg+xml"),`data:image/${c};base64,${r}`};t.useEffect(()=>{R(T)},[T]),t.useEffect(()=>{if(W.length>0){const a=W[0],r=l[a.id];if(r){const c=a.opciones?.find(Z=>Z.id===r);if(c){const Z=a.opciones?.indexOf(c)||0;h(String.fromCharCode(65+Z))}}else h("")}},[W,l]);const q=m.map((a,r)=>r+1).filter(a=>{const r=m[a-1];return r&&l[r.id]!==void 0&&l[r.id]!==null}),U=m.length||20,$=W[0],ee=$?.texto_pregunta||"Cargando pregunta...",V=$?.peso_pregunta||0,P=$?.opciones?.map((a,r)=>({id:String.fromCharCode(65+r),text:a.texto_opcion,isCorrect:a.opcion_correcta,originalId:a.id,imagen:S(a.imagen_opcion)||void 0}))||[],Q=a=>{G(a)},A=a=>{h(a);const r=a.charCodeAt(0)-65,c=$?.opciones?.[r];c&&$&&_($.id,c.id)},se=()=>{K&&J()},ge=()=>{ae&&Y()};return o?e.jsx("div",{className:"container-fluid p-0",children:e.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:e.jsx("h2",{children:"Cargando cuestionario..."})})}):b?e.jsx("div",{className:"container-fluid p-0",children:e.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[e.jsx("h2",{children:"Error"}),e.jsx("p",{children:b}),e.jsx("button",{onClick:()=>i("/estudiante"),children:"Volver al Dashboard"})]})}):d?e.jsxs("div",{className:"container-fluid p-0",children:[e.jsx("div",{className:"d-none d-md-flex",style:{position:"fixed",top:C?"auto":12,right:C?"auto":12,bottom:C?12:"auto",left:C?12:"auto",zIndex:2e3,color:C?"#111827":"white",boxShadow:"0 6px 18px rgba(0,0,0,0.2)",fontWeight:700,letterSpacing:.3,display:"flex",alignItems:"center",justifyContent:"center",width:88,height:88,borderRadius:"50%",background:`conic-gradient(rgba(0,0,0,0.18) ${f}%, rgba(0,0,0,0.06) 0)`},"aria-label":`Tiempo restante ${B(D)} de ${B(E)}`,title:`Tiempo restante ${B(D)} de ${B(E)}`,children:e.jsxs("div",{style:{position:"relative",inset:0,width:78,height:78,borderRadius:"50%",backgroundColor:C?"#ffffff":ie,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:2,boxShadow:C?"inset 0 0 0 2px rgba(0,0,0,0.08)":"inset 0 0 0 2px rgba(255,255,255,0.15)"},children:[e.jsx("i",{className:"bi bi-stopwatch","aria-hidden":"true",style:{fontSize:18,lineHeight:1,color:C?"#111827":"#ffffff"}}),e.jsx("span",{style:{fontSize:18,lineHeight:1,fontWeight:800,color:C?"#111827":"#ffffff"},children:B(D)})]})}),e.jsxs("div",{className:"px-2 px-md-2 px-lg-1 px-xl-1",style:{maxWidth:"98%",margin:"0 auto"},children:[e.jsx("div",{className:k.examHeader,children:e.jsx(Ne,{title:d?.titulo||"Cargando...",docente:le,programa:v,nivel:I})}),e.jsx("div",{className:k.examNavigation,children:e.jsx(Ce,{totalQuestions:U,answeredQuestions:q,currentQuestion:N,onQuestionSelect:Q})}),e.jsx("div",{className:k.examQuestion,children:e.jsx(ke,{timeRemaining:B(D),totalTime:B(E),timePercent:L,progress:Math.round(F)})}),e.jsx("div",{className:k.examAnswers,children:e.jsx("div",{className:k.componentCard,children:e.jsx(De,{questionText:ee,weight:V,answers:P,selectedAnswer:p,onAnswerSelect:A,questionImage:S($?.imagen_pregunta)||void 0,orientation:typeof $?.orientacion=="number"?$.orientacion:1,onImageClick:H,currentQuestion:N})})}),e.jsx("div",{className:k.examButtons,children:e.jsx(Be,{currentQuestion:N,totalQuestions:U,onPrevious:se,onNext:ge,isLastPage:ne,onSubmit:n,isSubmitting:x})}),C&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"1rem"},onClick:()=>H(null),children:e.jsxs("div",{style:{position:"relative",width:"95vw",height:"90vh",background:"white",borderRadius:16,boxShadow:"0 25px 50px rgba(0,0,0,0.4)",display:"flex",flexDirection:"column",overflow:"hidden"},onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem 1.5rem",background:"#2C3E50",color:"white"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:e.jsx("h3",{style:{margin:0,fontSize:"1.3rem",fontWeight:600,color:"white"},children:"Ampliar Imagen"})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("span",{style:{fontSize:"0.9rem",opacity:.9,color:"white"},children:["Pregunta ",N," de ",m.length]}),e.jsx("button",{onClick:()=>H(null),style:{background:"rgba(255,255,255,0.2)",color:"white",objectFit:"cover",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"50%",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:18,fontWeight:"bold",transition:"all 0.2s ease"},title:"Cerrar (ESC)",type:"button",onMouseEnter:a=>{a.currentTarget.style.background="rgba(255,255,255,0.3)"},onMouseLeave:a=>{a.currentTarget.style.background="rgba(255,255,255,0.2)"},children:e.jsx(Ue,{size:18})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.75rem 1.5rem",background:"#f8fafc",borderBottom:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("button",{onClick:()=>{const a=document.querySelector('img[alt="Imagen ampliada"]'),r=document.querySelector('input[type="range"]');if(a&&r){const c=Math.max(.5,parseFloat(r.value)-.2);a.style.transform=`scale(${c})`,r.value=c.toString()}},style:{background:"#3b82f6",color:"white",border:"none",borderRadius:8,padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:14,fontWeight:500,display:"flex",alignItems:"center",gap:"0.25rem"},title:"Alejar (Zoom Out)",type:"button",children:e.jsx(Ve,{size:16})}),e.jsx("button",{onClick:()=>{const a=document.querySelector('img[alt="Imagen ampliada"]'),r=document.querySelector('input[type="range"]');if(a&&r){const c=Math.min(3,parseFloat(r.value)+.2);a.style.transform=`scale(${c})`,r.value=c.toString()}},style:{background:"#3b82f6",color:"white",border:"none",borderRadius:8,padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:14,fontWeight:500,display:"flex",alignItems:"center",gap:"0.25rem"},title:"Acercar (Zoom In)",type:"button",children:e.jsx(he,{size:16})}),e.jsxs("button",{onClick:()=>{const a=document.querySelector('img[alt="Imagen ampliada"]'),r=document.querySelector('input[type="range"]'),c=document.querySelector("[data-image-container]");a&&r&&c&&(a.style.transform="scale(1)",r.value="1",c.scrollLeft=0,c.scrollTop=0)},style:{background:"#10b981",color:"white",border:"none",borderRadius:8,padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:14,fontWeight:500,display:"flex",alignItems:"center",gap:"0.25rem"},title:"Ajustar a ventana",type:"button",children:[e.jsx(qe,{size:16})," ",e.jsx("span",{style:{marginLeft:6},children:"Ajustar"})]})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.85rem",color:"#64748b"},children:e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[e.jsx(He,{})," Arrastra para mover • Rueda del mouse para zoom"]})})]}),e.jsx("div",{"data-image-container":!0,style:{flex:1,overflow:"auto",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(45deg, #f1f5f9 25%, transparent 25%), linear-gradient(-45deg, #f1f5f9 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #f1f5f9 75%), linear-gradient(-45deg, transparent 75%, #f1f5f9 75%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px",padding:"2rem",cursor:"grab",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",position:"relative"},onMouseDown:a=>{a.preventDefault();const r=a.currentTarget;let c=!0,Z=a.clientX,X=a.clientY,xe=r.scrollLeft,te=r.scrollTop;r.style.cursor="grabbing";const ce=fe=>{if(!c)return;fe.preventDefault();const ve=fe.clientX-Z,je=fe.clientY-X;r.scrollLeft=xe-ve,r.scrollTop=te-je},de=()=>{c=!1,r.style.cursor="grab",document.removeEventListener("mousemove",ce),document.removeEventListener("mouseup",de)};document.addEventListener("mousemove",ce),document.addEventListener("mouseup",de)},onWheel:a=>{a.preventDefault();const r=document.querySelector('img[alt="Imagen ampliada"]'),c=document.querySelector('input[type="range"]');if(r&&c){const Z=a.deltaY>0?-.1:.1,X=Math.max(.5,Math.min(3,parseFloat(c.value)+Z));r.style.transform=`scale(${X})`,c.value=X.toString()}},onDragStart:a=>a.preventDefault(),children:e.jsx("img",{src:C,alt:"Imagen ampliada",style:{maxWidth:"none",maxHeight:"none",width:"auto",height:"auto",objectFit:"contain",borderRadius:12,display:"block",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",pointerEvents:"none",WebkitTouchCallout:"none",boxShadow:"0 8px 32px rgba(0,0,0,0.2)",transition:"transform 0.1s ease-out"},draggable:!1,onDragStart:a=>a.preventDefault()})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",padding:"1rem 1.5rem",background:"#f8fafc",borderTop:"1px solid #e2e8f0"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"1rem",justifyContent:"center",flexWrap:"wrap"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:"14px",fontWeight:600,color:"#374151",minWidth:"60px"},children:[e.jsx(he,{})," Zoom:"]}),e.jsx("span",{id:"zoom-value",style:{fontSize:"13px",fontWeight:500,color:"#6366f1",minWidth:"40px",textAlign:"center"},children:"100%"}),e.jsx("input",{type:"range",min:"0.5",max:"3",step:"0.1",defaultValue:"1",style:{width:"200px",height:"8px",borderRadius:"4px",background:"linear-gradient(to right, #e2e8f0 0%, #6366f1 50%, #e2e8f0 100%)",outline:"none",cursor:"pointer",WebkitAppearance:"none",appearance:"none"},onChange:a=>{const r=document.querySelector('img[alt="Imagen ampliada"]'),c=document.getElementById("zoom-value");r&&c&&(r.style.transform=`scale(${a.target.value})`,c.textContent=`${Math.round(parseFloat(a.target.value)*100)}%`)}})]})}),e.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"0.5rem",fontSize:"0.8rem",color:"#64748b",flexWrap:"wrap"}})]})]})})]})]}):e.jsx("div",{className:"container-fluid p-0",children:e.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[e.jsx("h2",{children:"Cuestionario no encontrado"}),e.jsx("button",{onClick:()=>i("/estudiante"),children:"Volver al Dashboard"})]})})}function Ze(){return e.jsx("div",{className:"min-vh-100 w-100",style:{backgroundColor:"#F8F9FA",overflowX:"hidden"},children:e.jsx("div",{className:k.examContainer,children:e.jsx(Qe,{})})})}export{Ze as default};
